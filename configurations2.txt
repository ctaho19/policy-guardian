logger.info("Inspecting evaluated_roles_with_compliance:")
spark.sql("SELECT * FROM evaluated_roles_with_compliance").show(10)
non_compliant_count = spark.sql("SELECT COUNT(*) as non_compliant FROM evaluated_roles_with_compliance WHERE COMPLIANCE_STATUS = 'NonCompliant'").collect()[0]["non_compliant"]
logger.info(f"Non-compliant count in temp view: {non_compliant_count}")

