        compliance_status = when(
            (col("monitoring_metric") <= lit(warning_threshold)) &
            (warning_threshold.isNotNull()), "RED"
        ).when(
            (col("monitoring_metric") <= lit(alert_threshold)) &
            (alert_threshold.isNotNull()), "YELLOW"
        ).otherwise("GREEN")

# Determine compliance status based on thresholds, handling null cases
    tier2_compliance_status = (
        "RED" if tier2_warning_threshold is not None and tier2_metric <= tier2_warning_threshold
        else "YELLOW" if tier2_alert_threshold is not None and tier2_metric <= tier2_alert_threshold
        else "GREEN"
    )
