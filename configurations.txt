-- Check if we have any data at all in these tables
SELECT COUNT(*), MAX(BATCH_ID)
FROM CLCN_DB.PHDP_CLOUD.LAZER_CONTROLS_V03;

-- Check the join condition
SELECT COUNT(*) 
FROM CLCN_DB.PHDP_CLOUD.LAZER_CONTROLS_V03 LCTRL
LEFT JOIN CLCN_DB.PHDP_CLOUD.LAZER_COMPONENTS_V03 LCOMP 
    USING (CLOUD_CONTROL_ID, BATCH_ID);

-- Check what values we have for these fields
SELECT DISTINCT ESCALATING, PHASE, RESOURCE_TYPE
FROM CLCN_DB.PHDP_CLOUD.LAZER_CONTROLS_V03 LCTRL
LEFT JOIN CLCN_DB.PHDP_CLOUD.LAZER_COMPONENTS_V03 LCOMP 
    USING (CLOUD_CONTROL_ID, BATCH_ID)
WHERE LCTRL.BATCH_ID = (SELECT MAX(BATCH_ID) FROM CLCN_DB.PHDP_CLOUD.LAZER_CONTROLS_V03);
